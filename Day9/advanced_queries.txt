-----------------Q1:Advanced SQL Functions on a Single Table-----------------------------
_____________________________________________________________________________________________________

## Step 1: Use the Existing students Table
-------------------------------------------------
_____________________________________________________________________________________________________

## Step 2: Aggregate Queries
-----------------------------------------------

1.Count the total number of students

-SQL QUERY:
SELECT COUNT(*) AS total_students
FROM students;

-OUTPUT:

| total_students |
| -------------- |
| 4              |
_____________________________________________________________________________________________________


2.Find the average age of students

-SQL QUERY:

SELECT AVG(age) AS average_age
FROM students;


-OUTPUT:

| average_age         |
| ------------------- |
| 22.2500000000000000 |
_____________________________________________________________________________________________________


3.Find the minimum and maximum age

-SQL QUERY:

SELECT 
  MIN(age) AS minimum_age,
  MAX(age) AS maximum_age
FROM students;

-OUTPUT:

| minimum_age | maximum_age |
| ----------- | ----------- |
| 20          | 24          |

_____________________________________________________________________________________________________

4.Count how many students are enrolled in each course

-SQL QUERY:

SELECT 
  course,
  COUNT(*) AS student_count
FROM students
GROUP BY course;

-OUTPUT:

| course          | student_count |
| --------------- | ------------- |
| Backend         | 1             |
| UI Design       | 1             |
| Web Development | 2             |

_____________________________________________________________________________________________________

5.Count students whose age is greater than 20

-SQL QUERY:

SELECT COUNT(*) AS students_above_20
FROM students
WHERE age > 20;

-OUTPUT:

| students_above_20 |
| ----------------- |
| 3                 |

----------------------------------------------------------------------------------------------------
_____________________________________________________________________________________________________


## Step 3: Grouping & Filtering
---------------------------------------------

1.Display course-wise student count

-SQL QUERY:

SELECT 
  course,
  COUNT(*) AS student_count
FROM students
GROUP BY course;


-OUTPUT:

| course          | student_count |
| --------------- | ------------- |
| Backend         | 1             |
| UI Design       | 1             |
| Web Development | 2             |
_____________________________________________________________________________________________________



2.Display only courses where student count is greater than 1

-SQL QUERY:

SELECT 
  course,
  COUNT(*) AS student_count
FROM students
GROUP BY course
HAVING COUNT(*) > 1;


-OUTPUT:

| course          | student_count |
| --------------- | ------------- |
| Web Development | 2             |
_____________________________________________________________________________________________________


3.Display courses sorted by highest student count first

-SQL QUERY:

SELECT 
  course,
  COUNT(*) AS student_count
FROM students
GROUP BY course
ORDER BY student_count DESC;


-OUTPUT:

| course          | student_count |
| --------------- | ------------- |
| Web Development | 2             |
| Backend         | 1             |
| UI Design       | 1             |


----------------------------------------------------------------------------------------------------
_____________________________________________________________________________________________________

## Step 4: Ordering & Limiting

1.Fetch the latest 3 students based on created_at

-SQL QUERY:

SELECT *
FROM students
ORDER BY created_at DESC
LIMIT 3;


-OUTPUT:

| id | name  | email           | age | course          | created_at                 |
| -- | ----- | --------------- | --- | --------------- | -------------------------- |
| 3  | Neha  | neha@gmail.com  | 22  | Backend         | 2026-01-22 13:40:38.847818 |
| 4  | Pooja | pooja@gmail.com | 20  | UI Design       | 2026-01-22 13:40:38.847818 |
| 5  | Ravi  | ravi@gmail.com  | 23  | Web Development | 2026-01-22 13:40:38.847818 |
_____________________________________________________________________________________________________


2.Fetch the top 5 oldest students

-SQL QUERY:

SELECT *
FROM students
ORDER BY age DESC
LIMIT 5;


-OUTPUT:

| id | name  | email           | age | course          | created_at                 |
| -- | ----- | --------------- | --- | --------------- | -------------------------- |
| 1  | Rahul | rahul@gmail.com | 24  | Web Development | 2026-01-22 13:40:38.847818 |
| 5  | Ravi  | ravi@gmail.com  | 23  | Web Development | 2026-01-22 13:40:38.847818 |
| 3  | Neha  | neha@gmail.com  | 22  | Backend         | 2026-01-22 13:40:38.847818 |
| 4  | Pooja | pooja@gmail.com | 20  | UI Design       | 2026-01-22 13:40:38.847818 |

_____________________________________________________________________________________________________


3.Fetch students enrolled in a specific course, sorted by age (descending)

-SQL QUERY:

SELECT *
FROM students
WHERE course = 'Full Stack'
ORDER BY age DESC;


-OUTPUT:

Success. No rows returned

----------------------------------------------------------------------------------------------------
_____________________________________________________________________________________________________